# 浏览器底层

1. 当打开 chrome 时，意味着什么？

启动了一个主进程，main process，唯一PID，PID 是 Process ID 的缩写，进程ID。

上网的代理程序

“线程本身没有‘单/多’之分，‘单线程/多线程’是描述整个进程中线程的数量。”

一个进程要么是 单线程进程（只包含一个主线程），要么是 多线程进程（包含两个或更多线程）。

启动了一个进程 process ，进程中包含了一个或多个线程 thread ，其中有一个主线程 main thread ，主线程负责执行 js 代码。

进程是分配资源的最小单位

线程是 cpu 调度的最小单位，执行程序的最小单位

2. 为什么是 chrome？

chrome 最优秀，市场占有率最高的

3. 主要功能

1) HTML/CSS 渲染页面 render
2) V8 引擎，负责执行 JS 代码，JS 单线程机制，简单
3) 网络下载 network

## 浏览器是多进程多线程架构

1) 主进程 browser process

负责管理和调度其他子进程

2) GPU 进程 gpu process，负责处理图形渲染，加速页面显示

animation、transition、translate3D，这些动画效果都是在 GPU 进程中渲染的，不会阻塞主线程。

3) 网络进程 network process，负责处理网络请求

4) storage process，负责处理本地存储，缓存 LocalStorage、Cookie、前端数据库

5) 插件进程 plugin process，负责处理插件，如 flash、pdf 等

6) 标签页是独立的子进程 tab process

- 渲染进程 render process，渲染引擎 webkit，负责渲染页面，处理用户交互
  
- JS 执行进程，v8 引擎

JS 单线程（主线程），JS 就运行起来了


## 进程

分配资源的最小单位

每个 tab 页是一个独立的进程，内存开销大

独立使每个页面显示的更快，更安全，互不干扰

如果不独立，当一个进程或线程崩溃的话，所有页面都会崩溃

IE浏览器动不动就崩溃，是因为 IE 浏览器是单进程架构的，当 JS 代码执行阻塞时，会导致整个浏览器崩溃，所以需要多tap，多进程来做隔离，避免崩溃。

## 单线程

同步任务（sync）、异步任务（async）放到时间循环（event loop）中

## 多线程

并行处理

线程共享进程资源

- 当一个进程关闭之后，操作系统会回收进程所占用的内存

- 每一个进程只能访问自己占有的数据，不能访问其他进程的数据，如果崩溃了，也不会影响其他进程的运行。如果进程之间需要进行数据通信，需要通过进程间通信（IPC）机制来实现。

## 单进程浏览器 IE

## 多进程浏览器 chrome

1. 浏览器主进程

主要负责界面显示（浏览器软件界面）、用户交互、子进程管理、同时提供存储等功能

2. 渲染进程

核心任务是将HTML、CSS、JS 转换为用户可以与之交互的网页

排版引擎 webkit -> Blink 和 JS 引擎 V8 都运行在这里

默认情况，chrome 会为每个 Tab 标签创建一个渲染进程

3. GPU 进程

早期其实是没有的，只有渲染进程负责渲染页面，但是渲染进程的任务比较重，会阻塞主线程，导致页面卡顿，所以引入了 GPU 进程，负责处理图形渲染，加速页面显示。

GPU 使用的初衷是为了实现 3D CSS的效果，后面网页、UI都采用 GPU 来绘制，显卡加速

4. 网络进程

负责页面的网络资源加载，已经是一个独立的进程

5. 插件进程

flash、chrome extension

## 当打开一个页面的时候，为什么会有多个进程？ 有哪些进程？

1. 浏览器主进程
2. 渲染进程
3. GPU 进程
4. 网络进程
5. 插件进程